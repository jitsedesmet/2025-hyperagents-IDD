@prefix idd: <https://jitsedesmet.be/interface-data-description#> .
@prefix ex: <https://example.org#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

# My database is just a read interface not tied to a HTTP-resource.
<database>
    a idd:read-interface, idd:stateful-store ;
    idd:set-definition [
        idd:state-input [
            # A posted owner can just be added here
            idd:source <post-owners> ;
            idd:set-operation idd:union ;
        ], [
            idd:source <patch-owners> ;
            idd:mapping """
PREFIX ex: <https://example.org/>
CONSTRUCT {
    <idd:difference> { ?resource ex:name ?old-name }
    <idd:union> { ?resource ex:name ?new-name }
} WHERE {
    [] a ex:owner-patch;
       ex:name ?new-name ;
       ex:resource ?resource .
    # Wha!? Recursion? Contract: evaluated only once per event!
    <database> {
       ?resource ex:name ?old-name .
    }
}"""^^idd:sparql-1-1 ;
        ]
    ] .